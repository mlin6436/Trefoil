@using Telerik.Web.Mvc.UI
@model Trefoil.Web.Models.NoteModel

@{  
    Html.Telerik().Window()
        .Name(String.Format("note-details-{0}", Model.noteid))
        .Title("Note Details")
        .Content(
        @<text>
            @if (Model.organisationid != null)
            {
                using (Html.BeginForm("EditNote", "Client", FormMethod.Post, new { model = Model }))
                {
                    @Html.HiddenFor(model => model.noteid)
                    @Html.HiddenFor(model => model.organisationid)
                    <table>
                        <tr>
                            <td style="width: 100px;">
                                @Html.LabelFor(model => model.description)
                            </td>
                            <td >
                                @Html.TextAreaFor(model => model.description, new {style="width: 400px; height: 100px;"})
                                @Html.ValidationMessageFor(model => model.description)
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div>
                                    <button type="submit" class="t-button t-state-default" style="color: #fff; background: #4D90FE; font-weight: bold;">Save</button>
                                </div>
                            </td>
                        </tr>
                    </table>
                }
            }
            else if (Model.projectid != null)
            {
                using (Html.BeginForm("EditNote", "Project", FormMethod.Post, new { model = Model }))
                {
                    @Html.HiddenFor(model => model.noteid)
                    @Html.HiddenFor(model => model.projectid)
                    <table>
                        <tr>
                            <td style="width: 100px;">
                                @Html.LabelFor(model => model.description)
                            </td>
                            <td >
                                @Html.TextAreaFor(model => model.description, new {style="width: 400px; height: 100px;"})
                                @Html.ValidationMessageFor(model => model.description)
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div>
                                    <button type="submit" class="t-button t-state-default" style="color: #fff; background: #4D90FE; font-weight: bold;">Save</button>
                                </div>
                            </td>
                        </tr>
                    </table>
                }
            }
            else if (Model.taskid != null)
            {
                using (Html.BeginForm("EditNote", "Task", FormMethod.Post, new { model = Model }))
                {
                    @Html.HiddenFor(model => model.noteid)
                    @Html.HiddenFor(model => model.taskid)
                    <table>
                        <tr>
                            <td style="width: 100px;">
                                @Html.LabelFor(model => model.description)
                            </td>
                            <td >
                                @Html.TextAreaFor(model => model.description, new {style="width: 400px; height: 100px;"})
                                @Html.ValidationMessageFor(model => model.description)
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div>
                                    <button type="submit" class="t-button t-state-default" style="color: #fff; background: #4D90FE; font-weight: bold;">Save</button>
                                </div>
                            </td>
                        </tr>
                    </table>
                }
            }
            else
            {}
        </text>)
        .Width(600)
        .Draggable(true)
        .Modal(true)
        .Visible(false)
        .Render();
} 

@{
    Html.Telerik().ScriptRegistrar()
        .OnDocumentReady(
        @<text>
            $('#note-@Model.noteid')
                .click(function(e) {
                    e.preventDefault();
                    $('#note-details-@Model.noteid').data('tWindow').center().open();
                });
        </text>); 
}